/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */
plugins {
    id 'java'
    id 'idea'
    id 'groovy'
    id 'application'
    // ASSUMES GRADLE 2.12 OR HIGHER. Use plugin version 0.7.5 with earlier gradle versions
    // id 'com.google.protobuf' version '0.8.5'
}

repositories {
    maven {url 'http://maven.aliyun.com/nexus/content/groups/public/'}
    mavenLocal()
    mavenCentral()
}

// ⊕ [grpc-java/build.gradle at v1.19.0 · grpc/grpc-java](https://github.com/grpc/grpc-java/blob/v1.19.0/examples/build.gradle)
def grpcVersion = '1.19.0' // CURRENT_GRPC_VERSION
def protobufVersion = '3.6.1'
def protocVersion = protobufVersion

def nettyTcnativeVersion = '2.0.20.Final'

dependencies {
    compile 'org.codehaus.groovy:groovy-all:2.4.13'
    // compile "io.vertx:vertx-core:3.6.2"
    // compile "io.vertx:vertx-lang-groovy:3.6.2"
    compile 'javax.servlet:javax.servlet-api:4.0.0'
    compile 'javax.servlet.jsp:javax.servlet.jsp-api:2.3.2-b02'
    compile 'com.auth0:java-jwt:3.7.0'

    // grpc
    compileOnly "javax.annotation:javax.annotation-api:1.2"

    compile "com.google.api.grpc:proto-google-common-protos:1.0.0"
    // compile "io.grpc:grpc-core:${grpcVersion}"
    compile "io.grpc:grpc-alts:${grpcVersion}"
    compile "io.grpc:grpc-netty-shaded:${grpcVersion}"
    compile "io.grpc:grpc-protobuf:${grpcVersion}"
    compile "io.grpc:grpc-stub:${grpcVersion}"
    compile "com.google.protobuf:protobuf-java-util:${protobufVersion}"
    compile "io.grpc:grpc-netty:${grpcVersion}"

    compile "io.netty:netty-tcnative-boringssl-static:${nettyTcnativeVersion}"

    // https://mvnrepository.com/artifact/org.apache.arrow/arrow-vector
    compile group: 'org.apache.arrow', name: 'arrow-vector', version: '0.12.0'
    compile group: 'org.apache.arrow', name: 'arrow-memory', version: '0.12.0'

    compile group: 'com.google.inject', name: 'guice', version: '4.2.2'
    // https://mvnrepository.com/artifact/com.google.guava/guava
    compile group: 'com.google.guava', name: 'guava', version: '26.0-jre'
    // https://mvnrepository.com/artifact/commons-io/commons-io
    compile group: 'commons-io', name: 'commons-io', version: '2.6'
    // https://mvnrepository.com/artifact/org.yaml/snakeyaml
    compile group: 'org.yaml', name: 'snakeyaml', version: '1.23'
    // https://mvnrepository.com/artifact/com.google.protobuf/protobuf-java
    compile group: 'com.google.protobuf', name: 'protobuf-java', version: '3.6.1'

    implementation 'net.sf.smc:smc:7.0.0'
    compile 'com.rabbitmq:amqp-client:5.6.0'
    // https://mvnrepository.com/artifact/redis.clients/jedis
    compile group: 'redis.clients', name: 'jedis', version: '2.10.2'
    
    // minio
    // compile 'io.minio:minio:6.0.7'
    // https://mvnrepository.com/artifact/io.minio/minio
    compile group: 'io.minio', name: 'minio', version: '6.0.7'

    // dgraph
    // compile 'io.dgraph:dgraph4j:1.7.3'
    compile 'io.dgraph:dgraph4j:1.7.0'
    
    // akka
    compile 'com.typesafe.akka:akka-actor_2.12:2.5.21'
    // https://mvnrepository.com/artifact/com.typesafe.akka/akka-stream
    compile 'com.typesafe.akka:akka-stream_2.12:2.5.21'
    // https://mvnrepository.com/artifact/com.typesafe.akka/akka-http
    compile 'com.typesafe.akka:akka-http_2.12:10.1.7'
    // https://mvnrepository.com/artifact/com.typesafe.akka/akka-http-jackson
    compile 'com.typesafe.akka:akka-http-jackson_2.12:10.1.7'

    // https://mvnrepository.com/artifact/org.zeromq/jeromq
    compile group: 'org.zeromq', name: 'jeromq', version: '0.5.1'

    testCompile 'com.typesafe.akka:akka-testkit_2.12:2.5.21'
    // https://mvnrepository.com/artifact/org.scalatest/scalatest
    testCompile group: 'org.scalactic', name: 'scalactic_2.12', version: '3.0.6'
    testCompile group: 'org.scalatest', name: 'scalatest_2.12', version: '3.0.6'

    // compile fileTree(dir: file("${projectDir}/lib"), include: '**/*.jar')

    testCompile 'junit:junit:4.12'
    testCompile 'org.testng:testng:6.8.8'
}

/*
task execute(type:JavaExec) {
    main = mainClass
    classpath = sourceSets.main.runtimeClasspath
}
*/

jar {
    baseName = 'sagas-base'
    version =  '0.0.1'
}

task copyJar(type: Copy) {
    from jar // here it automatically reads jar file produced from jar task
    into '../ofbiz-framework/lib'
}

build.dependsOn copyJar

// mainClassName = "com.sagas.actors.AkkaQuickstart"
ext.mainClass = project.hasProperty('mainClass') ? project.getProperty('mainClass') : "com.sagas.actors.AkkaQuickstart" ;
mainClassName = ext.mainClass

// ./gradlew -PmainClass=Foo run
